<%- include('partials/admin/header.ejs') %> 

<div id="camadas">
  <div id="modalHere"></div>
  <div class="row">
    <div class="col-12">
        <table 
          class="table table-striped" 
          data-toggle="table" 
          data-url="/listlayers" 
          data-search="true"
          data-pagination="true"> 
          <thead class="thead-dark">
            <tr>
              <th data-checkbox="true"></th>
              <th data-field="id">ID</th>
              <th data-field="layerName">Nome da camada</th>
              <th data-field="layer">Nome da chamada</th>
              <th data-field="type">Tipo</th>
              <th data-field="group">Grupo</th>
              <th data-formatter='TableActions'>Opções</th>
          </thead>
        </table>
    </div>
  </div>
</div>
  
<!--Icones-->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">

<!--Bootstrap-table-->
<script src="/js/bootstrap-table/bootstrap-table.js" ></script>
<link rel="stylesheet" type="text/css" href="/css/bootstrap-table/bootstrap-table.css">

<script>
  $( document ).ready(function() {
    $('.fixed-table-toolbar').prepend('<button class="btn btn-dark layer-toolbar" id="remove-layers"  style="margin-right:5px;" onClick="removeMultipleLayers()">Remover Camadas</button> <a class="btn btn-dark layer-toolbar" id="addNewLayer"  style="margin-left:5px;" href="/layers/add"">Nova Camada</a>')
  });

  /* Aplicação de raio e margem nos botões de ação*/
   function TableActions(value, row, index, field) {
    return [`<button class="btn btn-dark btn-custom" id="removeLayer" data-toggle="modal" data-target="#modalLayer" onclick='modalLayer("`+row.layerName+`",`+row.id+`)'> <i class="fas fa-trash"></i></button>`, ' ', '<button class="btn btn-dark btn-custom2" id="editLayer" onclick="editLayer('+row.id+')"> <i class="fas fa-edit"></i></button>'].join('');
  }

  function removeMultipleLayers() {
    alert('em breve: deletar layer')
    //todo: desenvolver função para deletar layers marcadas
  }
  function removeLayer(index) {
    alert('em breve: remover esta layer: ' + index)
    //todo: desenvolver função para remover layer unica da tabela
  }
  function editLayer(index) {
    //alert('em breve: editar esta layer: ' + index )
    window.location.href = '/layers/edit/'+index
    //todo: desenvolver função para editar layer
  }
  function modalLayer(layerName, id){
    $('#modalHere').html(`
      <div class="modal fade" id="modalLayer" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-body">
              <p>Você está excluindo a camada `+layerName+`</p>
              <p>Confirmar ação ?</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-primary" onclick="removeLayer(`+id+`)">Sim</button>
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Não</button>
            </div>
          </div>
        </div>
      </div>
    `);
  }
  function removeLayer(index){
    window.location.href = '/layers/delete/'+index
  }
</script>
</div>
  
  <%- include('partials/admin/footer.ejs') %> 